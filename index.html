<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Focus-Tap | Concentraci√≥n Extrema</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-gradient: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            --glass-bg: rgba(255, 255, 255, 0.7);
            --glass-border: rgba(255, 255, 255, 0.5);
            --text-color: #2d3436;
            --accent-color: #6c5ce7;
            --danger-color: #ff7675;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Inter', sans-serif; }

        body {
            background: var(--bg-gradient);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            color: var(--text-color);
            transition: background 0.5s;
        }

        .container {
            width: 95%;
            max-width: 1100px;
            display: grid;
            grid-template-columns: 1.5fr 1fr;
            gap: 20px;
            padding: 20px;
        }

        .glass-card {
            background: var(--glass-bg);
            backdrop-filter: blur(10px);
            border: 1px solid var(--glass-border);
            border-radius: 24px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.05);
        }

        /* 1. TIMER PERSONALIZABLE */
        .timer-section { text-align: center; }
        #timer-display { font-size: 100px; font-weight: 600; margin: 10px 0; }
        
        .time-input-group { margin-bottom: 20px; }
        .time-input-group input {
            width: 60px; padding: 8px; border-radius: 8px; border: 1px solid #ddd; text-align: center;
        }

        /* 3. SONIDOS Y VOLUMEN */
        .mood-grid { display: grid; gap: 10px; margin-top: 15px; }
        .sound-row { display: flex; align-items: center; gap: 10px; background: rgba(255,255,255,0.4); padding: 10px; border-radius: 12px; }
        .sound-row button { border: none; background: none; cursor: pointer; font-size: 1.2rem; }
        input[type="range"] { flex-grow: 1; accent-color: var(--accent-color); }

        /* 2. NOTAS CON COPIADO */
        .notes-section { grid-column: 1 / -1; position: relative; }
        #brain-dump { width: 100%; height: 100px; border-radius: 15px; padding: 15px; border: 1px solid #ccc; margin-top: 10px; resize: none; }
        .copy-btn { position: absolute; top: 25px; right: 25px; padding: 5px 12px; border-radius: 8px; border: none; background: var(--accent-color); color: white; cursor: pointer; font-size: 0.8rem; }

        /* 4 & 5. CONCENTRACI√ìN IMPUESTA Y PENALIZACI√ìN */
        .extreme-mode-btn { background: var(--danger-color) !important; color: white !important; margin-top: 15px; }
        .penalty-warning { color: var(--danger-color); font-weight: bold; display: none; margin-top: 10px; font-size: 0.9rem; }

        /* 6. FRASES MOTIVADORAS */
        #motivation-box { min-height: 50px; display: flex; align-items: center; justify-content: center; text-align: center; font-style: italic; font-weight: 300; margin-top: 20px; border-top: 1px solid rgba(0,0,0,0.05); padding-top: 15px; }

        .streak-badge { position: fixed; top: 20px; left: 20px; background: white; padding: 8px 15px; border-radius: 20px; font-weight: bold; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
        
        button { cursor: pointer; transition: 0.2s; border-radius: 10px; border: none; padding: 10px 20px; font-weight: 600; }
        button:hover { opacity: 0.8; transform: translateY(-2px); }
        .btn-main { background: var(--accent-color); color: white; }

        /* Estilo para penalizaci√≥n (pantalla roja r√°pida) */
        .flash-red { animation: flash 0.5s; }
        @keyframes flash { 0% { background: rgba(255,0,0,0.4); } 100% { background: var(--bg-gradient); } }
    </style>
</head>
<body id="main-body">

    <div class="streak-badge">üî• Enfoque: <span id="streak-count">0</span></div>

    <div class="container">
        <div class="glass-card timer-section">
            <div class="time-input-group">
                <label>Minutos: </label>
                <input type="number" id="minutes-input" value="25" min="1" max="120">
            </div>
            <div id="timer-display">25:00</div>
            
            <div style="display: flex; justify-content: center; gap: 10px;">
                <button id="start-btn" class="btn-main">Iniciar Sesi√≥n</button>
                <button id="reset-btn">Reset</button>
            </div>

            <button id="extreme-btn" class="extreme-mode-btn">‚ö†Ô∏è Activar Concentraci√≥n Impuesta</button>
            <p id="penalty-msg" class="penalty-warning">¬°PENALIZACI√ìN! Te has distra√≠do. -10 segundos.</p>
            
            <div id="motivation-box">"Hazlo hoy, o arrepi√©ntete ma√±ana."</div>
        </div>

        <div class="glass-card">
            <h3>üéß Ambiente de Trabajo</h3>
            <div class="mood-grid">
                <div class="sound-row">
                    <button onclick="playTrack('rain')">üåßÔ∏è</button>
                    <input type="range" id="vol-rain" min="0" max="1" step="0.1" value="0.5">
                </div>
                <div class="sound-row">
                    <button onclick="playTrack('forest')">üå≤</button>
                    <input type="range" id="vol-forest" min="0" max="1" step="0.1" value="0.5">
                </div>
                <div class="sound-row">
                    <button onclick="playTrack('cafe')">‚òï</button>
                    <input type="range" id="vol-cafe" min="0" max="1" step="0.1" value="0.5">
                </div>
            </div>
            <p style="font-size: 0.7rem; margin-top: 15px; opacity: 0.6;">Pulsa el icono para Play/Pausa</p>
        </div>

        <div class="glass-card notes-section">
            <h3>üìù Notas R√°pidas (Brain Dump)</h3>
            <button class="copy-btn" onclick="copyNotes()">Copiar Texto</button>
            <textarea id="brain-dump" placeholder="Vuelca aqu√≠ tus pensamientos para no olvidarlos..."></textarea>
        </div>
    </div>

    <audio id="audio-rain" loop src="https://actions.google.com/sounds/v1/water/rain_on_roof.ogg"></audio>
    <audio id="audio-forest" loop src="https://actions.google.com/sounds/v1/ambiences/forest_morning_birds.ogg"></audio>
    <audio id="audio-cafe" loop src="https://actions.google.com/sounds/v1/ambiences/coffee_shop.ogg"></audio>

    <script>
        let timeLeft = 25 * 60;
        let timerId = null;
        let extremeMode = false;
        let penalties = 0;

        const display = document.getElementById('timer-display');
        const startBtn = document.getElementById('start-btn');
        const minutesInput = document.getElementById('minutes-input');
        const motivationBox = document.getElementById('motivation-box');
        const body = document.getElementById('main-body');

        const phrases = [
            "El trabajo duro vence al talento cuando el talento no trabaja duro.",
            "Solo un poco m√°s, est√°s cerca del descanso.",
            "Ignora las notificaciones, no valen tu tiempo.",
            "La disciplina es hacer lo que debes aunque no quieras.",
            "Tu mente es un m√∫sculo, entr√©nala para enfocarse.",
            "No pares cuando est√©s cansado, para cuando hayas terminado."
        ];

        // 1. MODIFICAR TIEMPO
        minutesInput.addEventListener('change', () => {
            if (!timerId) {
                timeLeft = minutesInput.value * 60;
                updateDisplay();
            }
        });

        function updateDisplay() {
            let mins = Math.floor(Math.round(timeLeft) / 60);
            let secs = Math.round(timeLeft) % 60;
            display.textContent = `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
        }

        // 2. COPIAR NOTAS
        function copyNotes() {
            const area = document.getElementById('brain-dump');
            area.select();
            document.execCommand('copy');
            alert("¬°Notas copiadas al portapapeles!");
        }

        // 3. SONIDOS Y VOLUMEN
        function playTrack(id) {
            const audio = document.getElementById('audio-' + id);
            const vol = document.getElementById('vol-' + id).value;
            audio.volume = vol;
            if (audio.paused) audio.play(); else audio.pause();
        }

        // 4. CONCENTRACI√ìN IMPUESTA (MODO EXTREMO)
        document.getElementById('extreme-btn').addEventListener('click', () => {
            const confirm1 = confirm("‚ö†Ô∏è ADVERTENCIA 1: Vas a activar el Modo Extremo. No deber√≠as cerrar esta p√°gina hasta terminar.");
            const confirm2 = confirm("‚ö†Ô∏è ADVERTENCIA 2: La p√°gina intentar√° bloquear tu salida y te penalizar√° si cambias de pesta√±a. ¬øEst√°s SEGURO?");
            if (confirm1 && confirm2) {
                extremeMode = true;
                document.documentElement.requestFullscreen();
                document.getElementById('extreme-btn').textContent = "üõ°Ô∏è MODO EXTREMO ACTIVO";
                document.getElementById('extreme-btn').style.background = "#2d3436";
            }
        });

        // 5. PENALIZACI√ìN POR DISTRACCI√ìN
        document.addEventListener("visibilitychange", () => {
            if (document.hidden && timerId) {
                penalties++;
                timeLeft = Math.max(0, timeLeft - 10); // Quita 10 segundos
                body.classList.add('flash-red');
                document.getElementById('penalty-msg').style.display = 'block';
                setTimeout(() => {
                    body.classList.remove('flash-red');
                    document.getElementById('penalty-msg').style.display = 'none';
                }, 2000);
            }
        });

        // 6. FRASES ALEATORIAS CADA MINUTO
        setInterval(() => {
            motivationBox.textContent = `"${phrases[Math.floor(Math.random() * phrases.length)]}"`;
        }, 60000);

        // L√ìGICA GENERAL TIMER
        startBtn.addEventListener('click', () => {
            if (timerId) {
                clearInterval(timerId);
                timerId = null;
                startBtn.textContent = 'Reanudar';
            } else {
                startBtn.textContent = 'Pausar';
                timerId = setInterval(() => {
                    timeLeft--;
                    updateDisplay();
                    if (timeLeft <= 0) {
                        clearInterval(timerId);
                        alert("¬°Misi√≥n cumplida!");
                        if (document.fullscreenElement) document.exitFullscreen();
                    }
                }, 1000);
            }
        });

        document.getElementById('reset-btn').addEventListener('click', () => {
            clearInterval(timerId);
            timerId = null;
            timeLeft = minutesInput.value * 60;
            updateDisplay();
            startBtn.textContent = 'Iniciar Sesi√≥n';
        });

        // Bloqueo de salida (Solo funciona si hay interacci√≥n previa)
        window.onbeforeunload = function() {
            if (extremeMode && timeLeft > 0) return "¬°Est√°s en modo extremo! No abandones tu meta.";
        };
    </script>
</body>
</html>
